<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="20201016 模拟赛题解"><meta name="keywords" content=""><meta name="author" content="hydd"><meta name="copyright" content="hydd"><title>20201016 模拟赛题解 | hydd's blog</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.8.2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.8.2"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '5.2.0'
} </script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="hydd's blog" type="application/atom+xml">
</head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#count"><span class="toc-number">1.</span> <span class="toc-text">count</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#path"><span class="toc-number">2.</span> <span class="toc-text">path</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E4%B8%AA%E7%BB%93%E8%AE%BA"><span class="toc-number">2.0.1.</span> <span class="toc-text">一个结论</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E9%97%AE"><span class="toc-number">2.1.</span> <span class="toc-text">第一问</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E9%97%AE"><span class="toc-number">2.2.</span> <span class="toc-text">第二问</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89"><span class="toc-number">2.3.</span> <span class="toc-text">定义</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%A6%E5%BC%80%E5%8F%B3%E5%BC%80%E6%9E%81%E7%9F%AD%E8%B7%AF%E5%BE%84"><span class="toc-number">2.3.1.</span> <span class="toc-text">左开右开极短路径</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%A6%E9%97%AD%E5%8F%B3%E5%BC%80%E6%9E%81%E7%9F%AD%E8%B7%AF%E5%BE%84"><span class="toc-number">2.3.2.</span> <span class="toc-text">左闭右开极短路径</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%A6%E5%BC%80%E5%8F%B3%E9%97%AD%E6%9E%81%E7%9F%AD%E8%B7%AF%E5%BE%84"><span class="toc-number">2.3.3.</span> <span class="toc-text">左开右闭极短路径</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%A6%E9%97%AD%E5%8F%B3%E9%97%AD%E6%9E%81%E7%9F%AD%E8%B7%AF%E5%BE%84"><span class="toc-number">2.3.4.</span> <span class="toc-text">左闭右闭极短路径</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#graph"><span class="toc-number">3.</span> <span class="toc-text">graph</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">hydd</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">34</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">9</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">13</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1601458971422&amp;di=b8daa23ca0b94063c28207d10326c892&amp;imgtype=0&amp;src=http%3A%2F%2Fattach.bbs.miui.com%2Fforum%2F201412%2F14%2F202225id4jvijttjt6ffjs.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">hydd's blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a><a class="site-page" href="/template">Template</a><a class="site-page" href="/record">Record</a></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title">20201016 模拟赛题解</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-10-19</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E7%9C%81%E9%80%89%E6%A8%A1%E6%8B%9F%E8%B5%9B/">省选模拟赛</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h2 id="count"><a href="#count" class="headerlink" title="count"></a>count</h2><ul>
<li>不想重新再手打一遍了 QAQ。</li>
<li>算了再打一遍吧。</li>
</ul>
<script type="math/tex; mode=display">
\begin{align*}
f_m(n)&=\sum_{i=0}^na_i\sum_{j=0}^n(-1)^j\binom{m}{j}\binom{n-m}{i-j}\\
\\
F(x)&=\sum_{i=0}^nx^i\sum_{j=0}^n(-1)^j\binom{m}{j}\binom{n-m}{i-j}\\
&=\sum_{a=0}^m\sum_{b=0}^{n-m}\left(\binom{m}{a}x^a(-1)^a\right)\left(\binom{n-m}{b}x^b\right)\\
&=\sum_{a=0}^m\left(\binom{m}{a}(-x)^a1^{m-a}\right)\sum_{b=0}^{n-m}\left(\binom{n-m}{b}x^b1^{n-m-b}\right)\\
&=(1-x)^m(1+x)^{n-m}\\
&=(2-(1+x))^m(1+x)^{n-m}\\
&=\sum_{i=0}^m\binom{m}{i}2^i(1+x)^{m-i}(-1)^{m-i}(1+x)^{n-m}\\
&=\sum_{i=0}^m\binom{m}{i}2^i(1+x)^{n-i}(-1)^{m-i}\\
&=\sum_{i=0}^m\binom{m}{i}2^i(-1)^{m-i}\left(\sum_{j=0}^{n-i}\binom{n-i}{j}x^j\right)\\
\\
f_m(n)&=\sum_{i=0}^m\binom{m}{i}2^i(-1)^{m-i}\left(\sum_{j=0}^{n-i}\binom{n-i}{j}a_j\right)\\
\\
G(x)&=f_0(n)x^0+f_1(n)x^1+f_2(n)x^2+\cdots+f_n(n)x^n\\
&=\sum_{m=0}^nf_m(n)x^m\\
&=\sum_{m=0}^n x^m\sum_{i=0}^m\binom{m}{i}2^i(-1)^{n-i}\left(\sum_{j=0}^{n-i}\binom{n-i}{j}a_j\right)\\
&=\sum_{m=0}^n m!\sum_{i=0}^m\frac{2^i\left(\sum_{j=0}^{n-i}\binom{n-i}{j}a_j\right)x^i}{i!}\frac{(-1)^{m-i}x^{m-i}}{(m-i)!}\\
\\
D(x)&=\sum_{i=0}^n2^i\left(\sum_{j=0}^{n-i}\binom{n-i}{j}a_j\right)\frac{x^i}{i!}\\
E(x)&=\sum_{i=0}^n(-1)^i\frac{x^i}{i!}
\\
G(x)&=\sum_{m=0}^n m!x^m\sum_{i=0}^mD[x^i]E[x^{m-i}]\\
&=\sum_{m=0}^n m!x^m(D\times E)[x^m]\\
\\
D(x)&=\sum_{i=0}^n2^i\left(\sum_{j=0}^{n-i}\binom{n-i}{j}a_j\right)\frac{x^i}{i!}\\
C(x)&=\sum_{i=0}^nx^i\sum_{j=0}^{i}\binom{i}{j}a_j\\
&=\sum_{i=0}^ni!\sum_{j=0}^{i}\frac{a_jx^j}{j!}\frac{x^{i-j}}{(i-j)!}\\
\\
A(x)&=\sum_{i=0}^{n}a_i\frac{x^i}{i!}\\
B(x)&=\sum_{i=0}^{n}\frac{x^i}{i!}\\
C(x)&=\sum_{i=0}^n i!x^i\sum_{j=0}^iA[x^j]B[x^{i-j}]\\
&=\sum_{i=0}^n i!x^i(A\times B)[x^i]\\
D(x)&=\sum_{i=0}^n2^iC[x^{n-i}]\frac{x^i}{i!}\\
E(x)&=\sum_{i=0}^n(-1)^i\frac{x^i}{i!}\\
G(x)&=\sum_{m=0}^n m!x^m(D\times E)[x^m]\\
Ans&=G(1000000007)
\end{align*}</script><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*********************************************************************</span></span><br><span class="line"><span class="comment"> * Source：安师大省选模拟2</span></span><br><span class="line"><span class="comment"> * Problem：count - T1</span></span><br><span class="line"><span class="comment"> * Author：hydd</span></span><br><span class="line"><span class="comment"> * Date：2020/10/16</span></span><br><span class="line"><span class="comment">*********************************************************************/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> g=<span class="number">3</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Mod=<span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">unsigned</span> val=<span class="number">1000000007</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;ll&gt; poly;</span><br><span class="line"><span class="keyword">int</span> n,s,m,t,rev[<span class="number">2100000</span>];</span><br><span class="line">ll fac[<span class="number">2100000</span>],inv[<span class="number">2100000</span>];</span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">Getchar</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">char</span> now[<span class="number">1</span>&lt;&lt;<span class="number">20</span>],*S,*T;</span><br><span class="line">    <span class="keyword">if</span> (T==S)&#123;</span><br><span class="line">        T=(S=now)+fread(now,<span class="number">1</span>,<span class="number">1</span>&lt;&lt;<span class="number">20</span>,<span class="built_in">stdin</span>);</span><br><span class="line">        <span class="keyword">if</span> (T==S) <span class="keyword">return</span> EOF;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> *S++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">char</span> ch=Getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (ch==<span class="string">&#x27;-&#x27;</span>) f=<span class="number">-1</span>;</span><br><span class="line">        ch=Getchar();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch&lt;=<span class="string">&#x27;9&#x27;</span>&amp;&amp;ch&gt;=<span class="string">&#x27;0&#x27;</span>) x=x*<span class="number">10</span>+ch-<span class="string">&#x27;0&#x27;</span>,ch=Getchar();</span><br><span class="line">    <span class="keyword">return</span> x*f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">add</span><span class="params">(ll x,ll y)</span></span>&#123; <span class="keyword">return</span> x+y&gt;=Mod?x+y-Mod:x+y;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">dec</span><span class="params">(ll x,ll y)</span></span>&#123; <span class="keyword">return</span> x-y&lt;<span class="number">0</span>?x-y+Mod:x-y;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">mul</span><span class="params">(ll x,ll y)</span></span>&#123; <span class="keyword">return</span> x*y%Mod;&#125;</span><br><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll x,ll a)</span></span>&#123;</span><br><span class="line">    ll res=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (a)&#123;</span><br><span class="line">        <span class="keyword">if</span> (a&amp;<span class="number">1</span>) res=res*x%Mod;</span><br><span class="line">        x=x*x%Mod; a&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">getinv</span><span class="params">(ll x)</span></span>&#123; <span class="keyword">return</span> qpow(x,Mod<span class="number">-2</span>);&#125;</span><br><span class="line"></span><br><span class="line">poly A,B,C;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT</span><span class="params">(poly &amp;a,<span class="keyword">int</span> len,<span class="keyword">int</span> inv)</span></span>&#123;</span><br><span class="line">    a.resize(len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i++)</span><br><span class="line">        <span class="keyword">if</span> (i&lt;rev[i]) swap(a[i],a[rev[i]]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> mid=<span class="number">1</span>;mid&lt;len;mid&lt;&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">        ll tmp=qpow(g,(Mod<span class="number">-1</span>)/(mid&lt;&lt;<span class="number">1</span>));</span><br><span class="line">        <span class="keyword">if</span> (inv==<span class="number">-1</span>) tmp=getinv(tmp);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i+=(mid&lt;&lt;<span class="number">1</span>))&#123;</span><br><span class="line">            ll omega=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;mid;j++,omega=mul(omega,tmp))&#123;</span><br><span class="line">                ll x=a[i+j],y=mul(omega,a[i+j+mid]);</span><br><span class="line">                a[i+j]=add(x,y); a[i+j+mid]=dec(x,y);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (inv==<span class="number">-1</span>)&#123;</span><br><span class="line">        ll inv=getinv(len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i++) a[i]=mul(a[i],inv);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mult</span><span class="params">(poly a,poly b,poly &amp;c,<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> bit=<span class="number">0</span>; <span class="keyword">while</span> ((<span class="number">1</span>&lt;&lt;bit)&lt;n+n) bit++;</span><br><span class="line">    <span class="keyword">int</span> len=<span class="number">1</span>&lt;&lt;bit;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i++) rev[i]=(rev[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(bit<span class="number">-1</span>));</span><br><span class="line">    NTT(a,len,<span class="number">1</span>); NTT(b,len,<span class="number">1</span>);</span><br><span class="line">    c.resize(len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i++) c[i]=mul(a[i],b[i]);</span><br><span class="line">    NTT(c,len,<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	freopen(<span class="string">&quot;count.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	freopen(<span class="string">&quot;count.out&quot;</span>,<span class="string">&quot;w&quot;</span>,<span class="built_in">stdout</span>);</span><br><span class="line">	fac[<span class="number">0</span>]=<span class="number">1</span>; <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">2000000</span>;i++) fac[i]=fac[i<span class="number">-1</span>]*i%Mod;</span><br><span class="line">	inv[<span class="number">1</span>]=<span class="number">1</span>; <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=<span class="number">2000000</span>;i++) inv[i]=(Mod-Mod/i)*inv[Mod%i]%Mod;</span><br><span class="line">	inv[<span class="number">0</span>]=<span class="number">1</span>; <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">2000000</span>;i++) inv[i]=inv[i<span class="number">-1</span>]*inv[i]%Mod;</span><br><span class="line">	n=read(); A.resize(n+<span class="number">1</span>); B.resize(n+<span class="number">1</span>);</span><br><span class="line">	B[<span class="number">0</span>]=read(); s=read(); m=read(); t=read();</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=n;i++) A[i]=inv[i];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) B[i]=((B[i<span class="number">-1</span>]^s)*m+t)%Mod;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=n;i++) B[i]=B[i]*inv[i]%Mod;</span><br><span class="line">	mult(A,B,C,n+<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=n;i++) C[i]=C[i]*fac[i]%Mod;</span><br><span class="line">	A.resize(n+<span class="number">1</span>); B.resize(n+<span class="number">1</span>); ll now=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		A[i]=C[n-i]*inv[i]%Mod*now%Mod;</span><br><span class="line">		now=add(now,now);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		B[i]=inv[i];</span><br><span class="line">		<span class="keyword">if</span> (i&amp;<span class="number">1</span>) B[i]=(Mod-B[i])%Mod;</span><br><span class="line">	&#125;</span><br><span class="line">	mult(A,B,C,n+<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=n;i++) C[i]=C[i]*fac[i]%Mod;	</span><br><span class="line">	<span class="keyword">unsigned</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i=n;i&gt;=<span class="number">0</span>;i--) ans=ans*val+(<span class="keyword">unsigned</span>)C[i];</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%u\n&quot;</span>,ans);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="path"><a href="#path" class="headerlink" title="path"></a>path</h2><h4 id="一个结论"><a href="#一个结论" class="headerlink" title="一个结论"></a>一个结论</h4><ul>
<li>先给出一个结论：<ul>
<li>一条合法的路径上，一定存在一条边 $(a,b)$，使得这条边上的顶点序列，存在相邻的两个点 $a,b$。</li>
<li>证明：<ul>
<li>考虑设函数 $f(x)$ 表示走过 $x$ 个点的时候，经过的边上的顶点序列的长度之和。</li>
<li>$f(1)=0,f(n)=n$，$f(x)$ 单调不降。</li>
<li>原命题等价于存在 $1\leq i&lt;n,f(i)&lt;i,f(i+1)\geq i+1$。 显然成立。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="第一问"><a href="#第一问" class="headerlink" title="第一问"></a>第一问</h3><ul>
<li>我们可以对所有满足“这条边上的顶点序列上存在相邻的两个点 $a,b$”的所有边 $(a,b)$，往左右不断扩展，看是否合法。若合法，输出即可。</li>
</ul>
<h3 id="第二问"><a href="#第二问" class="headerlink" title="第二问"></a>第二问</h3><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><ul>
<li><p>现在，我们定义 $4$ 种路径：</p>
<ul>
<li>左开右闭：路径上的边的顶点序列接起来，没有路径上的第一个点。</li>
<li>左闭右开：路径上的边的顶点序列接起来，没有路径上的最后一个点。</li>
<li>左闭右闭：路径上的边的顶点序列接起来，有路径上的所有点。</li>
<li>左开右开：路径上的边的顶点序列接起来，没有路径上的第一个点和最后一个点。</li>
</ul>
</li>
<li><p>我们定义极短路径为：不能切割得到更短的路径拼接起来。（这个定义对以上 $4$ 种都成立）</p>
</li>
</ul>
<h4 id="左开右开极短路径"><a href="#左开右开极短路径" class="headerlink" title="左开右开极短路径"></a>左开右开极短路径</h4><ul>
<li>若一条边上顶点序列为空，那这条边就是左开右开极短路径。</li>
<li>如果有更长的左开右开路径，那么不是极短的。</li>
<li>它必定可以用 左开右开极短路径+左闭右开路径 或 左开右闭极短路径+左开右开路径表示。</li>
<li>取决于它的第一条边上的顶点序列是否为空。</li>
</ul>
<h4 id="左闭右开极短路径"><a href="#左闭右开极短路径" class="headerlink" title="左闭右开极短路径"></a>左闭右开极短路径</h4><ul>
<li>枚举这种路径的结尾边 $(u,v)$。</li>
<li>结尾边上的顶点序列最后一个点若为 $u$，那么往左扩展，如果合法，就是一条极短的左闭右开路径。</li>
<li>这个求出来的路径显然两两不同。（因为它只向一边扩展）</li>
<li>接下来证明它不能由 左闭右开路径+左闭右开极短路径 或 左闭右闭路径+左开右开极短路径表示。<ul>
<li>第一种显然不可能，现在是固定最后一个点，往左扩展，如果扩展到已经满足条件了，就不会再扩展了。</li>
<li>第二种也不可能，左开右开极短路径是一条顶点序列为空的边，而现在的路径要求结尾边的顶点序列最后一个点为 $u$，矛盾。</li>
</ul>
</li>
</ul>
<h4 id="左开右闭极短路径"><a href="#左开右闭极短路径" class="headerlink" title="左开右闭极短路径"></a>左开右闭极短路径</h4><ul>
<li>先建反图，将路径上的顶点序列也反过来。</li>
<li>剩下的做法和“左闭右开极短路径”一样，证明也同理。</li>
</ul>
<h4 id="左闭右闭极短路径"><a href="#左闭右闭极短路径" class="headerlink" title="左闭右闭极短路径"></a>左闭右闭极短路径</h4><ul>
<li>可以通过第一问的方法可以得到若干条极短的合法（左闭右闭）路径。</li>
<li>但是，它往两边扩展，会不会有两个满足条件的边，它们扩展出来是同一条路径呢？</li>
<li>可以发现，求出来的极短的合法（左闭右闭）路径是两两不重复的。</li>
<li>证明：<ul>
<li>如果有重复，那就说明有一条极短的合法路径，上面出现了两条边 $(a_1,b_1),(a_2,b_2)$ 满足条件（这条边上的顶点序列上存在相邻的两个点 $a,b$）</li>
<li>不妨设在路径上 $(a_1,b_1)$ 在 $(a_2,b_2)$ 之前出现。那么 $(a_2,b_2)$ 是 $(a_1,b_1)$ 向右扩展时走到的。</li>
<li>那么，如果要加入 $(a_2,b_2)$ 这条边，那么在加入这条边之前的时刻，剩下将要经过的顶点序列中，前两个为 $(a_2,b_2)$。现在加入这条边后，将要经过的顶点序列中有新出现了 $(a_2,b_2)$，那么路径成环了，不可能长度 $\leq 2*n$。</li>
</ul>
</li>
<li>由于中心边唯一，扩展出的路径必定是极短路径。</li>
</ul>
<ul>
<li>可以发现，每个路径只有一种极短路径分解方法，否则就和极短的定义矛盾了。</li>
<li>由于这些路径唯一，所以这些路径组合拼接成的更长的路径，也是不重复的。</li>
<li>记 $dp1[0/1][0/1][i][j][k]$ 分别表示左开/闭，右开/闭，起点为 $i$，终点为 $j$，长度为 $k$ 的极短路径条数。</li>
<li>记 $dp2[k][i][0/1]$ 分别表示路径长度为 $k$，当前路径最后一个点为 $i$， 是开/闭的路径条数。</li>
<li>答案为 $\sum_k\sum_i dp2[k][i][1]$。</li>
<li>时间复杂度 $O(n^2m+n^3)$。</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*********************************************************************</span></span><br><span class="line"><span class="comment"> * Source：安师大省选模拟2</span></span><br><span class="line"><span class="comment"> * Problem：path - T2  （CF331E1/E2）</span></span><br><span class="line"><span class="comment"> * Author：hydd</span></span><br><span class="line"><span class="comment"> * Date：2020/10/18</span></span><br><span class="line"><span class="comment">*********************************************************************/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;utility&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> n,m,num[<span class="number">110</span>][<span class="number">110</span>],v[<span class="number">110</span>];</span><br><span class="line"><span class="keyword">int</span> top,s[<span class="number">21000</span>],top2,s2[<span class="number">21000</span>];</span><br><span class="line"><span class="keyword">int</span> ans,Ans[<span class="number">21000</span>];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vec[<span class="number">21000</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> x,y,k;</span><br><span class="line">&#125; a[<span class="number">21000</span>];</span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">Getchar</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">char</span> now[<span class="number">1</span>&lt;&lt;<span class="number">20</span>],*S,*T;</span><br><span class="line">	<span class="keyword">if</span> (T==S)&#123;</span><br><span class="line">		T=(S=now)+fread(now,<span class="number">1</span>,<span class="number">1</span>&lt;&lt;<span class="number">20</span>,<span class="built_in">stdin</span>);</span><br><span class="line">		<span class="keyword">if</span> (T==S) <span class="keyword">return</span> EOF;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> *S++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=Getchar();</span><br><span class="line">	<span class="keyword">while</span> (ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span> (ch==<span class="string">&#x27;-&#x27;</span>) f=<span class="number">-1</span>;</span><br><span class="line">		ch=Getchar();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span> (ch&lt;=<span class="string">&#x27;9&#x27;</span>&amp;&amp;ch&gt;=<span class="string">&#x27;0&#x27;</span>) x=x*<span class="number">10</span>+ch-<span class="string">&#x27;0&#x27;</span>,ch=Getchar();</span><br><span class="line">	<span class="keyword">return</span> x*f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">pii <span class="title">get_path</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">bool</span> rev)</span></span>&#123;<span class="comment">//从正边/反边上走</span></span><br><span class="line">	<span class="keyword">int</span> now=<span class="number">0</span>,y,e;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=top&amp;&amp;top&lt;=<span class="number">2</span>*n;i++)&#123;</span><br><span class="line">		y=s[i]; e=num[x][y];</span><br><span class="line">		<span class="keyword">if</span> (!e||(rev&amp;&amp;e&lt;=m)||(!rev&amp;&amp;e&gt;m)) <span class="keyword">return</span> pii(<span class="number">2</span>*n+<span class="number">1</span>,<span class="number">2</span>*n+<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;(<span class="keyword">int</span>)vec[e].size();j++) s[++top]=vec[e][j];</span><br><span class="line">		x=y; now++;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> pii(top,x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> dp1[<span class="number">2</span>][<span class="number">2</span>][<span class="number">55</span>][<span class="number">55</span>][<span class="number">110</span>],dp2[<span class="number">110</span>][<span class="number">55</span>][<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> f[<span class="number">55</span>][<span class="number">55</span>][<span class="number">110</span>],g[<span class="number">55</span>][<span class="number">55</span>][<span class="number">110</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">(<span class="keyword">bool</span> rev)</span></span>&#123;<span class="comment">//路径是否反过来了</span></span><br><span class="line">	<span class="built_in">memset</span>(f,<span class="number">0</span>,<span class="keyword">sizeof</span>(f));</span><br><span class="line">	<span class="built_in">memset</span>(g,<span class="number">0</span>,<span class="keyword">sizeof</span>(g));</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m*<span class="number">2</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span> ((rev&amp;&amp;i&lt;=m)||(!rev&amp;&amp;i&gt;m)) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;(<span class="keyword">int</span>)vec[i].size();j++)</span><br><span class="line">			<span class="keyword">if</span> (vec[i][j]==a[i].x)&#123;</span><br><span class="line">				top=<span class="number">0</span>; <span class="keyword">for</span> (<span class="keyword">int</span> k=j<span class="number">-1</span>;k&gt;=<span class="number">0</span>;k--) s[++top]=vec[i][k];</span><br><span class="line">				pii res=get_path(a[i].x,!rev);</span><br><span class="line">				<span class="keyword">if</span> (res.first+<span class="number">1</span>&gt;<span class="number">2</span>*n) <span class="keyword">continue</span>;</span><br><span class="line">				<span class="keyword">if</span> (j+<span class="number">1</span>==(<span class="keyword">int</span>)vec[i].size())</span><br><span class="line">					g[res.second][a[i].y][res.first+<span class="number">1</span>]++;<span class="comment">//左闭右开</span></span><br><span class="line">				<span class="keyword">else</span>&#123;</span><br><span class="line">					<span class="keyword">if</span> (vec[i][j+<span class="number">1</span>]!=a[i].y) <span class="keyword">continue</span>;</span><br><span class="line">					top2=<span class="number">0</span>;</span><br><span class="line">					<span class="keyword">for</span> (<span class="keyword">int</span> i=top;i&gt;=<span class="number">1</span>;i--) s2[++top2]=s[i];</span><br><span class="line">					top=<span class="number">0</span>; <span class="keyword">for</span> (<span class="keyword">int</span> k=j+<span class="number">2</span>;k&lt;(<span class="keyword">int</span>)vec[i].size();k++) s[++top]=vec[i][k];</span><br><span class="line">					pii res2=get_path(a[i].y,rev);</span><br><span class="line">					</span><br><span class="line">					<span class="keyword">if</span> (res2.first+<span class="number">1</span>+res.first&gt;<span class="number">2</span>*n) <span class="keyword">continue</span>;</span><br><span class="line">					<span class="keyword">if</span> (!ans)&#123;</span><br><span class="line">						<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=top2;i++) Ans[++ans]=s2[i];</span><br><span class="line">						Ans[++ans]=a[i].x; Ans[++ans]=a[i].y;</span><br><span class="line">						<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=top;i++) Ans[++ans]=s[i];</span><br><span class="line">					&#125;</span><br><span class="line">					f[res.second][res2.second][res2.first+<span class="number">1</span>+res.first]++;<span class="comment">//左闭右闭</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	freopen(<span class="string">&quot;path.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	freopen(<span class="string">&quot;path.out&quot;</span>,<span class="string">&quot;w&quot;</span>,<span class="built_in">stdout</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m); <span class="keyword">int</span> x,y,k;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">		x=read(); y=read(); k=read();</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=k;j++) v[j]=read();</span><br><span class="line">		</span><br><span class="line">		a[i].x=x; a[i].y=y; a[i].k=k;</span><br><span class="line">		num[x][y]=i;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=k;j++) vec[i].push_back(v[j]);</span><br><span class="line">		</span><br><span class="line">		a[i+m].x=y; a[i+m].y=x; a[i+m].k=k;</span><br><span class="line">		num[y][x]=i+m;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=k;j++) vec[i+m].push_back(v[k-j+<span class="number">1</span>]);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span> (!k) dp1[<span class="number">0</span>][<span class="number">0</span>][x][y][<span class="number">1</span>]++;</span><br><span class="line">	&#125;</span><br><span class="line">	work(<span class="literal">false</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> k=<span class="number">1</span>;k&lt;=n*<span class="number">2</span>;k++)&#123;</span><br><span class="line">				dp1[<span class="number">1</span>][<span class="number">1</span>][i][j][k]=f[i][j][k];</span><br><span class="line">				dp1[<span class="number">1</span>][<span class="number">0</span>][i][j][k]=g[i][j][k];</span><br><span class="line">			&#125;</span><br><span class="line">	<span class="keyword">if</span> (ans)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,ans);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;ans;i++) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,Ans[i]);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,Ans[ans]);</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">&quot;0\n&quot;</span>);</span><br><span class="line">	work(<span class="literal">true</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> k=<span class="number">1</span>;k&lt;=n*<span class="number">2</span>;k++)</span><br><span class="line">				dp1[<span class="number">0</span>][<span class="number">1</span>][i][j][k]=g[j][i][k];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> k=<span class="number">1</span>;k&lt;=n*<span class="number">2</span>;k++)&#123;</span><br><span class="line">				dp2[k][j][<span class="number">0</span>]=(dp2[k][j][<span class="number">0</span>]+dp1[<span class="number">1</span>][<span class="number">0</span>][i][j][k])%Mod;</span><br><span class="line">				dp2[k][j][<span class="number">1</span>]=(dp2[k][j][<span class="number">1</span>]+dp1[<span class="number">1</span>][<span class="number">1</span>][i][j][k])%Mod;</span><br><span class="line">			&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> p=<span class="number">1</span>;p&lt;=n*<span class="number">2</span>;p++)&#123;</span><br><span class="line">		<span class="keyword">int</span> res=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">			res=(res+dp2[p][i][<span class="number">1</span>])%Mod;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> m=<span class="number">0</span>;m&lt;=<span class="number">1</span>;m++)</span><br><span class="line">				<span class="keyword">if</span> (dp2[p][i][m])&#123;</span><br><span class="line">					<span class="keyword">for</span> (<span class="keyword">int</span> s=<span class="number">0</span>;s&lt;=<span class="number">1</span>;s++)</span><br><span class="line">						<span class="keyword">for</span> (<span class="keyword">int</span> x=<span class="number">1</span>;x&lt;=n;x++)</span><br><span class="line">							<span class="keyword">for</span> (<span class="keyword">int</span> q=<span class="number">1</span>;q&lt;=n*<span class="number">2</span>-p;q++)</span><br><span class="line">								dp2[p+q][x][s]=(dp2[p+q][x][s]+<span class="number">1l</span>l*dp2[p][i][m]*dp1[m^<span class="number">1</span>][s][i][x][q])%Mod;</span><br><span class="line">				&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,res);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="graph"><a href="#graph" class="headerlink" title="graph"></a>graph</h2><ul>
<li>建立一个这样的网络模型：<ul>
<li>新建一个汇点 $T$（不妨设它为$(-\inf,-\inf)$），在原图上选一个点（不妨选横坐标最小的点，保证平面图的性质），将 $T$ 和这个点连边。</li>
<li>每个点自带一个单位的流量，流量沿着原图的边可以双向流动。</li>
</ul>
</li>
<li>那么原图所有点的流出量-流入量=1。</li>
<li>可以发现，因为原图是个平面图，所以一个环内的点数是从环上流出环的流量总和-从环外流入环的流量总和。</li>
<li>如何求一个可行的流量呢？就直接随便搞一颗以 $T$ 为根的生成树即可，每个点往父亲的流量就是这个点的子树大小。</li>
<li>从环外流入环的流量总和=父亲在环上，自己在环外的点的子树大小之和。</li>
<li>从环上流出环的流量总和=父亲在环外，自己在环上的点的子树大小之和。</li>
<li>*这个大小就是边上的流量。</li>
</ul>
<ul>
<li>由于是平面图，所以对于环上的任意点，把它的所有出边按极角排序，那么往环外走的边是一段连续的区间。</li>
<li>答案=环上流出环的流量总和-从环外流入环的流量总和。对于每个在环上的点：<ul>
<li>“从环上流出环的流量总和=父亲在环外，自己在环上的点的子树大小之和”。当前点在环上，若父亲在环外，有贡献 $+sz[fa]$。</li>
<li>“从环外流入环的流量总和=父亲在环上，自己在环外的点的子树大小之和”。当前点在环上，若儿子在环外，有贡献 $-sz[son]$。</li>
<li>*流出为负，流入为正，类似于正向边和反向边。</li>
</ul>
</li>
<li>可以将每个点的出边极角排序，父亲的贡献设为 $+sz[]$，儿子的贡献设为 $-sz[]$，由于往环外走的边是一段连续的区间，求这个区间贡献之和即可。</li>
<li>怎么求这个区间呢？这个可以将每条边极角排序的排名记录下来，就可以得到区间的两个端点。（具体实现可以看代码）</li>
<li>因为题目没有说是顺时针还是逆时针方向，所以求出了区间的两个端点后，不知道哪一部分是在环内，哪一部分是在环外，所以我们要规定方向。</li>
<li>随便在环上选一个点 $O$，对环上的任意一条边，求出 $O$ 和它围成三角形的有向面积（叉积 $ab\sin\theta$），求和看正负即可判断是顺时针还是逆时针。</li>
<li>比如我们统一为逆时针，给出的是顺时针，就把给出的点 $reverse$ 一下即可。（具体实现看代码）</li>
</ul>
<ul>
<li>时间复杂度：<ul>
<li>预处理，求生成树 $O(n)$。</li>
<li>将每个点的出边极角排序，最坏情况下为 $O(m\log m)$。</li>
<li>求答案 $O(\sum k)$。</li>
</ul>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*********************************************************************</span></span><br><span class="line"><span class="comment"> * Source：安师大省选模拟2</span></span><br><span class="line"><span class="comment"> * Problem：graph - T3  （CF223E）</span></span><br><span class="line"><span class="comment"> * Author：hydd</span></span><br><span class="line"><span class="comment"> * Date：2020/10/17</span></span><br><span class="line"><span class="comment">*********************************************************************/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;utility&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">int</span> n,m,q,k,a[<span class="number">110000</span>],cnt,tmp[<span class="number">110000</span>];</span><br><span class="line"><span class="keyword">int</span> edgenum=<span class="number">1</span>,vet[<span class="number">610000</span>],val[<span class="number">610000</span>],Next[<span class="number">610000</span>],Head[<span class="number">110000</span>];</span><br><span class="line"><span class="keyword">double</span> ang[<span class="number">610000</span>]; <span class="keyword">bool</span> vis[<span class="number">110000</span>];</span><br><span class="line"><span class="built_in">map</span>&lt;pii,<span class="keyword">int</span>&gt; rnk;</span><br><span class="line"><span class="built_in">vector</span>&lt;ll&gt; sum[<span class="number">110000</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> x,y;</span><br><span class="line">	node()&#123;&#125;</span><br><span class="line">	node(<span class="keyword">int</span> _x,<span class="keyword">int</span> _y):x(_x),y(_y)&#123;&#125;</span><br><span class="line">&#125; p[<span class="number">110000</span>];</span><br><span class="line">node <span class="keyword">operator</span>-(<span class="keyword">const</span> node &amp;a,<span class="keyword">const</span> node &amp;b)&#123; <span class="keyword">return</span> node(a.x-b.x,a.y-b.y);&#125;</span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">Getchar</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">char</span> now[<span class="number">1</span>&lt;&lt;<span class="number">20</span>],*S,*T;</span><br><span class="line">	<span class="keyword">if</span> (T==S)&#123;</span><br><span class="line">		T=(S=now)+fread(now,<span class="number">1</span>,<span class="number">1</span>&lt;&lt;<span class="number">20</span>,<span class="built_in">stdin</span>);</span><br><span class="line">		<span class="keyword">if</span> (T==S) <span class="keyword">return</span> EOF;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> *S++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">char</span> ch=Getchar();</span><br><span class="line">	<span class="keyword">while</span> (ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span> (ch==<span class="string">&#x27;-&#x27;</span>) f=<span class="number">-1</span>;</span><br><span class="line">		ch=Getchar();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span> (ch&lt;=<span class="string">&#x27;9&#x27;</span>&amp;&amp;ch&gt;=<span class="string">&#x27;0&#x27;</span>) x=x*<span class="number">10</span>+ch-<span class="string">&#x27;0&#x27;</span>,ch=Getchar();</span><br><span class="line">	<span class="keyword">return</span> x*f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    vet[++edgenum]=v;</span><br><span class="line">    Next[edgenum]=Head[u];</span><br><span class="line">	Head[u]=edgenum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">	vis[u]=<span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">int</span> flow=<span class="number">1</span>,tmp;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> e=Head[u];e;e=Next[e])</span><br><span class="line">		<span class="keyword">if</span> (!vis[vet[e]])&#123;</span><br><span class="line">			tmp=dfs(vet[e]);</span><br><span class="line">			val[e]+=tmp; val[e^<span class="number">1</span>]-=tmp;</span><br><span class="line">			flow+=tmp;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">return</span> flow;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123; <span class="keyword">return</span> ang[a]&lt;ang[b];&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">cross</span><span class="params">(node x,node y)</span></span>&#123; <span class="keyword">return</span> <span class="number">1l</span>l*x.x*y.y<span class="number">-1l</span>l*x.y*y.x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	freopen(<span class="string">&quot;graph.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line">	freopen(<span class="string">&quot;graph.out&quot;</span>,<span class="string">&quot;w&quot;</span>,<span class="built_in">stdout</span>);</span><br><span class="line">	n=read(); m=read(); <span class="keyword">int</span> u,v;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">		u=read(); v=read();</span><br><span class="line">		addedge(u,v); addedge(v,u);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) p[i].x=read(),p[i].y=read();</span><br><span class="line">	p[n+<span class="number">1</span>].x=<span class="number">-1e9</span>; p[n+<span class="number">1</span>].y=<span class="number">-1e9</span>;</span><br><span class="line">	<span class="keyword">int</span> rt=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">		<span class="keyword">if</span> (p[i].x&lt;p[rt].x) rt=i;</span><br><span class="line">	addedge(n+<span class="number">1</span>,rt);</span><br><span class="line">	dfs(n+<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> u=<span class="number">1</span>;u&lt;=n;u++)&#123;</span><br><span class="line">		cnt=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> e=Head[u];e;e=Next[e])&#123;</span><br><span class="line">			tmp[++cnt]=e; v=vet[e];</span><br><span class="line">			ang[e]=<span class="built_in">atan2</span>(p[v].y-p[u].y,p[v].x-p[u].x);</span><br><span class="line">		&#125;</span><br><span class="line">		sort(tmp+<span class="number">1</span>,tmp+cnt+<span class="number">1</span>,cmp);</span><br><span class="line">		sum[u].push_back(<span class="number">0</span>);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=cnt;i++)&#123;</span><br><span class="line">			rnk[pii(u,vet[tmp[i]])]=i;</span><br><span class="line">			sum[u].push_back(sum[u].back()+val[tmp[i]]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	q=read(); <span class="keyword">int</span> l,r;</span><br><span class="line">	<span class="keyword">while</span> (q--)&#123;</span><br><span class="line">		k=read();</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=k;i++) a[i]=read();</span><br><span class="line">		ll s=<span class="number">0</span>,ans=k;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;k;i++) s+=cross(p[a[i]]-p[a[<span class="number">1</span>]],p[a[i+<span class="number">1</span>]]-p[a[<span class="number">1</span>]]);</span><br><span class="line">		<span class="keyword">if</span> (s&lt;<span class="number">0</span>) reverse(a+<span class="number">1</span>,a+k+<span class="number">1</span>);</span><br><span class="line">		<span class="comment">//现在必定是逆时针</span></span><br><span class="line">		a[<span class="number">0</span>]=a[k]; a[k+<span class="number">1</span>]=a[<span class="number">1</span>];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=k;i++)&#123;</span><br><span class="line">			l=rnk[pii(a[i],a[i+<span class="number">1</span>])];</span><br><span class="line">			r=rnk[pii(a[i],a[i<span class="number">-1</span>])];</span><br><span class="line">			ans+=sum[a[i]][r]-sum[a[i]][l<span class="number">-1</span>];</span><br><span class="line">			<span class="keyword">if</span> (l&gt;r) ans+=sum[a[i]][(<span class="keyword">int</span>)sum[a[i]].size()<span class="number">-1</span>];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,ans);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">hydd</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://hydd.cf/2020/10/19/sol_23/">http://hydd.cf/2020/10/19/sol_23/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2020/10/21/sol_24/"><i class="fa fa-chevron-left">  </i><span>20201021 模拟赛题解</span></a></div><div class="next-post pull-right"><a href="/2020/10/14/sol_22/"><span>CF1188D 题解</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1601458971422&amp;di=b8daa23ca0b94063c28207d10326c892&amp;imgtype=0&amp;src=http%3A%2F%2Fattach.bbs.miui.com%2Fforum%2F201412%2F14%2F202225id4jvijttjt6ffjs.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2020 By hydd</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.8.2"></script><script src="/js/fancybox.js?version=1.8.2"></script><script src="/js/sidebar.js?version=1.8.2"></script><script src="/js/copy.js?version=1.8.2"></script><script src="/js/fireworks.js?version=1.8.2"></script><script src="/js/transition.js?version=1.8.2"></script><script src="/js/scroll.js?version=1.8.2"></script><script src="/js/head.js?version=1.8.2"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>